# SRI JDC config with eHash Mint Mode
listening_address = "127.0.0.1:34265"

# Version support
max_supported_version = 2
min_supported_version = 2

# Auth keys for open encrypted connection downstream
authority_public_key = "9auqWEzQDVyd2oe1JVGFLMLHZtCo2FFqZwtKA5gd9xbuEu7PH72"
authority_secret_key = "mkDLTBBRxdBv998612qipDYoTK3YUrqLe8uWw7gu3iXbSrn2n"
cert_validity_sec = 3600


# User identity/username for pool connection
user_identity = "your_username_here"

# target number of shares per minute applied to every downstream channel
shares_per_minute = 6.0

# Share batch size
share_batch_size = 10

# JDC supports two modes:
# "FULLTEMPLATE"  - full template mining
# "COINBASEONLY" - coinbase-only mining
mode = "FULLTEMPLATE"

# Template Provider config
# Local TP (this is pointing to localhost so you must run a TP locally for this configuration to work)
tp_address = "127.0.0.1:8442"
# Hosted testnet TP
# tp_address = "75.119.150.111:8442"

# string to be added into the Coinbase scriptSig
jdc_signature = "Sv2MinerSignature"

# Solo Mining config
# Coinbase output used to build the coinbase tx in case of Solo Mining (as last-resort solution of the pools fallback system)
#
# Coinbase outputs are specified as descriptors. A full list of descriptors is available at
#     https://github.com/bitcoin/bips/blob/master/bip-0380.mediawiki#appendix-b-index-of-script-expressions
# Although the `musig` descriptor is not yet supported and the legacy `combo` descriptor never
# will be. If you have an address, embed it in a descriptor like `addr(<address here>)`.
coinbase_reward_script = "addr(tb1qa0sm0hxzj0x25rh8gw5xlzwlsfvvyz8u96w3p8)"

# Enable this option to set a predefined log file path.
# When enabled, logs will always be written to this file.
# The CLI option --log-file (or -f) will override this setting if provided.
# log_file = "./jd-client.log"

# JDC locking pubkey (hpub format: bech32-encoded with 'hpub' HRP)
# This pubkey is used when JDC forwards shares upstream:
# - Mint mode: JDC uses this pubkey (acting as a normal miner to upstream Pool)
# - Wallet mode: This is used as fallback; per-downstream miner pubkeys are preferred
# Format: hpub1... (33-byte compressed secp256k1 public key)
# Example below is a valid hpub - generate your own for production use
jdc_locking_pubkey = "hpub1qgdq86h8jrvy9hkx6cq4kxjmhd93qmt8vv2rgvcf8sqfee54vkmvqkf79u6"

# List of upstreams (JDS) used as backup endpoints
# In case of shares refused by the JDS, the fallback system will propose the same job to the next upstream in this list
[[upstreams]]
authority_pubkey = "9auqWEzQDVyd2oe1JVGFLMLHZtCo2FFqZwtKA5gd9xbuEu7PH72"
pool_address = "127.0.0.1"
pool_port = 34254
jds_address = "127.0.0.1"
jds_port = 34264

[[upstreams]]
authority_pubkey = "9auqWEzQDVyd2oe1JVGFLMLHZtCo2FFqZwtKA5gd9xbuEu7PH72"
pool_address = "75.119.150.111"
pool_port = "34254"
jds_address = "75.119.150.111"
jds_port = "34264"

##############################################
# eHash Configuration - Mint Mode
##############################################
# JDC can operate in mint mode to create eHash tokens for validated shares
# This is useful when JDC acts as a standalone mining pool with eHash support

[ehash_config]
# Mode can be "mint" or "wallet"
# - mint: JDC mints eHash tokens for shares it validates
# - wallet: JDC tracks correlation data (like TProxy does)
mode = "mint"

# Mint configuration (required when mode = "mint")
[ehash_config.mint]
# URL where the mint is accessible
mint_url = "https://mint.hashpool.local"

# Optional: Mint private key for CDK Mint initialization
# If not provided, a new key will be generated
# mint_private_key = "your_mint_private_key_here"

# Optional: Database URL for CDK persistence
# Supports: sqlite, postgres, redb backends
# If not provided, uses in-memory database (not recommended for production)
database_url = "sqlite://jdc_ehash_mint.db"

# Minimum leading zero bits required to earn 1 unit of eHash
# Default: 32 (hashpool standard)
min_leading_zeros = 32

# Optional: Supported currency units for minting
# Default: ["HASH", "sat"]
# supported_units = ["HASH", "sat"]

# Fault tolerance configuration
# Maximum retry attempts before disabling mint operations (default: 10)
max_retries = 10

# Backoff multiplier in seconds for retry logic (default: 2)
backoff_multiplier = 2

# Enable automatic recovery from failures (default: true)
recovery_enabled = true

# Optional: Log level for mint operations
# log_level = "info"
